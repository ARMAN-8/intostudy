var uk_data={lat:53.4,lng:-3.4861348,zoom:6,markers:[]},usa_data={lat:37.2581436,lng:-95.494658,zoom:4,markers:[]},china_data={lat:34.4975477,lng:103.720018,zoom:4,markers:[]},mapStyle=[];function startupMap(){$.each($("#uk + .map-list .centre-list-item"),function(a,t){var e="";if(void 0!==$(t).attr("data-url")&&(e=$(t).attr("data-url")),!$(t).find(".accordian-control").hasClass("nopin")){var l={pos:{lat:parseFloat($(t).attr("data-lat"),10),lng:parseFloat($(t).attr("data-lng"),10)},name:$(t).find(".accordian-control").text(),nolink:$(t).hasClass("nolink"),url:e};$(t).attr("id",slugify(l.name)),uk_data.markers.push(l)}}),$.each($("#usa + .map-list .centre-list-item"),function(a,t){var e="";if(void 0!==$(t).attr("data-url")&&(e=$(t).attr("data-url")),!$(t).find(".accordian-control").hasClass("nopin")){var l={pos:{lat:parseFloat($(t).attr("data-lat"),10),lng:parseFloat($(t).attr("data-lng"),10)},name:$(t).find(".accordian-control").text(),url:e};$(t).attr("id",slugify(l.name)),usa_data.markers.push(l)}}),$.each($("#china + .map-list .centre-list-item"),function(a,t){var e="";if(void 0!==$(t).attr("data-url")&&(e=$(t).attr("data-url")),!$(t).find(".accordian-control").hasClass("nopin")){var l={pos:{lat:parseFloat($(t).attr("data-lat"),10),lng:parseFloat($(t).attr("data-lng"),10)},name:$(t).find(".accordian-control").text(),url:e};$(t).attr("id",slugify(l.name)),china_data.markers.push(l)}}),initMap(uk_data)}function initMap(a){new google.maps.StyledMapType(mapStyle,{name:"Styled"});var t,e=new google.maps.Map(document.getElementById("map"),{center:{lat:a.lat,lng:a.lng},zoom:a.zoom,disableDefaultUI:!0,scrollwheel:!1,disableDoubleClickZoom:!1,zoomControl:!0,styles:mapStyle});$.each(a.markers,function(a,l){var i=new google.maps.Marker({position:l.pos,map:e,title:l.name,icon:"/images/map-marker.png"});i.addListener("click",function(){var a='<div class="l-map-info-content">';a+="<p>"+l.name+"</p>",""!==l.url&&(a+='<a href="'+l.url+'" class="cta l-cta">View more</a>'),a+="</div>";var n=new InfoBubble({content:a,maxWidth:300,shadowStyle:1,backgroundClassName:"l-map-info-window",backgroundColor:"#414042",borderWidth:0,borderRadius:6,arrowStyle:0,shadowStyle:0,padding:10,closeSrc:"/images/map-close.gif"}),o=$(window).width(),s=Math.round(o/100*80)-30;$(window).width()<=370&&n.setMaxWidth(s),t&&t.close(),n.open(e,i),t=n,$(".l-map-info-window").parent().css({height:"auto"})})})}function slugify(a){return a.replace(/\s/g,"-").toLowerCase()}$(".location-button").click(function(a){switch(a.preventDefault(),$(".location-button").removeClass("is-active"),$(this).addClass("is-active"),$(this).attr("id")){case"uk":initMap(uk_data);break;case"usa":initMap(usa_data);break;case"china":initMap(china_data);break;default:initMap(uk_data)}$(".l-map-module").removeClass("is-expanded"),$(window).width()<1030&&$("body").animate({scrollTop:$(".l-map-module").offset().top-50},500)}),$(".map-switch > a").click(function(a){a.preventDefault(),$(".map-switch > a").removeClass("is-active"),$(this).addClass("is-active"),"list"!==$(this).attr("id")?$(".l-map-module").removeClass("list"):$(".l-map-module").addClass("list")}),$(".expand-close").click(function(a){a.preventDefault(),$(".is-expanded").removeClass("is-expanded")}),$("body").on("click",".show-details",function(a){a.preventDefault();var t=$(a.target).attr("data-target");$(".is-expanded").removeClass("is-expanded"),$(".l-map-module").addClass("is-expanded"),$(t).addClass("is-expanded"),$(window).width()<1030&&$("body").animate({scrollTop:$(t).offset().top},500)}),startupMap();